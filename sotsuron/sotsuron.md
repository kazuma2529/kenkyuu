# フラン鋳型における砂粒子接触数の計測プログラム開発と解析

### 融体加工研究室　化21-0146　得能 一眞

---

# 目次

頁

1. 緒言 .................................................... 1

2. 実験手順および計算方法 .................................. 2
   2.1 試料作製 ........................................... 2
   2.2 X線CT撮影 .......................................... 2
   2.3 画像処理アルゴリズム ................................ 3
   2.3.1 3D二値化処理 ................................. 3
   2.3.2 粒子分割処理 ................................. 4
   2.3.3 最適パラメータ自動決定アルゴリズム ............ 5
   2.3.4 Guard Volume機能 ............................. 6
   2.4 可視化手法 ......................................... 7

3. 結果および考察 .......................................... 8
   3.1 収縮回数rの最適化 .................................. 8
   3.2 接触数分布の解析 ................................... 9
   3.3 粒子体積と接触数の相関解析 ......................... 10
   3.4 3D可視化による内部構造の評価 ....................... 11
   3.5 Guard Volume機能の効果 ............................. 12
   3.6 システムの妥当性検証 ............................... 13

4. 結言 ................................................... 13

5. 参考文献 ............................................... 14

謝辞 ...................................................... 15

---

## 1. 緒言

　鋳型は、鋳物を作製するときに用いられる溶湯を流し込む型である。鋳型の一種に砂粒同士（珪砂等）を粘結剤で接着することにより造型する砂型があり、砂型の一種に有機自硬性鋳型がある。有機自硬性鋳型は、鋳物砂に粘結剤と硬化剤を混錬し、鋳物砂同士を接着することで造型される。フラン鋳型は、有機自硬性鋳型の中でも主流となるものの一つである 1)。砂の再利用性、鋳物の寸法精度や鋳肌の品質が良い事が特徴であり、粘結剤として使われるフラン樹脂は非可食バイオマス原料由来のためカーボンニュートラルの観点からも注目されている 2)。

　一方、フラン樹脂は有機物であることからガス欠陥の原因となる。また、造型時にホルムアルデヒド、注湯時に亜硫酸ガスが発生し作業環境への悪影響の原因となる 3)ため、少量での使用が望ましい。しかし、フラン樹脂の添加量を少量にすると鋳型強度が低下するという問題がある。そのため、鋳型内の砂の充填構造を最適化することで強度を向上させることができれば、フラン樹脂の添加量を少量にできると考えられる。

　X 線 CT を用いてシェル鋳型抗折力試験片の内部構造を解析した事例がある 4)ことから、充填構造を観察する方法として X 線 CT を用いた手法が有効であると考えられる。ここで、材料は異なるがフラン鋳型と内部構造が類似しているポーラスコンクリート（以下 POC）に着目する。POC は、骨材とペーストからなるコンクリートの一種である。POC において、骨材の配位数（接触数）の増加は圧縮強度の増加の要因とされている 5)。このことから、フラン鋳型においても鋳物砂粒子の接触数の増加が圧縮強度の向上に寄与する可能性がある。

　既往の X 線 CT 解析では、粒子分離や画像境界の統計誤差（境界効果）の処理、3 次元可視化に課題があった。具体的には、二値化された画像において接触している砂粒子が一つの塊として誤認識される問題、試料端部に位置する粒子が切出しによって接触相手を失い接触数が過小評価される問題、そして接触数の空間分布を直感的に把握することが困難であるという問題があった。

　本研究では、これらの課題を解決するため、境界効果を排除して粒子接触数を正確に計測するプログラムを開発し、鋳型内部構造を解析した。具体的には、収縮回数を変動させながら最大粒子体積割合と平均接触数の推移を監視し、過分離と未分離のバランスが最適となるパラメータを自動決定するアルゴリズムを実装した。また、境界効果を排除するための Guard Volume 機能を開発し、各粒子の接触数に応じた 3 次元可視化システムを構築した。

---

## 2. 実験手順および計算方法

### 2.1 試料作製

　本研究で使用したフラン鋳型試料は、鋳物砂にフラン樹脂および硬化剤を所定量混錬し、常温で硬化させることにより作製した。使用した鋳物砂の粒度分布を Fig. 1 に示す。同図より、平均直径 362 μm の粒子が 61.9% を占めており、比較的均一な粒度分布を有していることがわかる。作製した試料から、X 線 CT 撮影に適した寸法の試料片を切り出した。

### 2.2 X線CT撮影

　試料片の内部構造を非破壊で観察するため、X 線 CT 撮影を行った。X 線 CT は、試料に X 線をコーンビーム状に照射し、光軸内で回転させて検出器に拡大投影するという手法である 6)。試料を透過し減衰した X 線を検出器で測定することで、X 線の強度が二次元像として測定される。得られたデータに再構成処理を行うことにより、試料の断面画像が得られる。

　本研究では、196 枚の二次元断面画像を取得した。各画像の解像度は 512 × 512 ピクセルであり、1 ボクセルあたりのサイズは 14 μm である。これらの断面画像を積層することにより、3 次元ボクセルデータを構築した。

### 2.3 画像処理アルゴリズム

#### 2.3.1 3D二値化処理

　X 線 CT の出力データはグレイスケールであり、鋳物砂粒子と空間の境界線は必ずしも明確ではない。そのため、砂粒子と空間あるいは樹脂との境界を明確にするためにグレイスケールのデータを二値化によって白黒画像にする必要がある。Fig. 2 にグレイスケールの画像とそれを二値化した画像の例を示す。同図上段に示す画像において矢印で示した領域は砂粒子の境界であるが、その輪郭は不明瞭である。

　本研究では、大津の二値化法 7)を用いて二値化処理を行った。大津の二値化法は、画像の明度ヒストグラムから大域最適な閾値を自動的に決定し、グレイスケールの画像を白と黒の二つの値に変換する手法である。さらに、本研究では 2 段階の大津の二値化を採用した。第 1 段階では、全体のボリュームに対して大津の二値化を適用し、背景と前景を大まかに分離する。第 2 段階では、第 1 段階で抽出された前景領域に対して再度大津の二値化を適用し、砂粒子領域をより精密に抽出する。この 2 段階処理により、CT データの広いダイナミックレンジに対応した高精度な二値化が可能となった。

　また、砂粒子が明るく映る場合と暗く映る場合の両方に対応するため、前景極性の自動判定機能を実装した。二値化後のボクセル数を比較し、少数派のボクセルを砂粒子として判定することで、撮影条件に依存しない汎用的な処理を実現した。Fig. 2 の下段に示すように、二値化によって輪郭は明瞭となり、鋳物砂とそれ以外を一義的に扱えるようになった。

#### 2.3.2 粒子分割処理

　フラン鋳型の X 線 CT 像を二値化した断面像の例を Fig. 3 に示す。同図において白色領域が鋳物砂であり、黒色領域が空隙あるいは粘結剤に相当する領域である。鋳物砂を角のある粒子として視認することができるが、多くの粒子が接しており、白色領域としては連続してつながっている粒子が多く認められる。接触数の測定においては、つながっている粒子を分離して認識する必要がある。

　本研究では、粒子分割のための手法として、ユークリッド距離変換および Watershed 法を用いた。距離変換とは、二値化された画像において、各前景ピクセルから最も近い背景ピクセルまでの距離を計算する処理である。Fig. 4 に距離変換の概念図を示す。同図より、粒子の中心部ほど距離値が大きくなり、粒子境界では距離値が小さくなることがわかる。

　Watershed 法は、抽出する領域の中心を地形の起伏の谷、領域同士の境界を地形の尾根とそれぞれみなし、山地に降り注ぐ雨水が分水嶺の両側に流れ込むように、その尾根を境界として領域を分割する処理である 8)。本研究では、距離変換の結果を負の値に反転させたものを標高データとして Watershed 法に入力し、粒子の分割を行った。

　粒子分割において重要なパラメータが収縮回数 r である。Fig. 5 に画像収縮の模式図を示す。同図(a)より、二値化された画像には粒子が接触して合体しているものや粒子表面に X 線 CT 測定のアーチファクト由来のノイズが存在する。同図(b)および(c)より、画像を収縮していくとノイズは粒子から分離して消滅する。また、同図(c)では合体していた粒子が分離して認識される。しかし、収縮量が過剰になると同図(d)に示すように粒子が消滅する。このように、分離と消滅を考慮しつつ適切な収縮回数を決定する必要がある。

#### 2.3.3 最適パラメータ自動決定アルゴリズム

　収縮回数 r の選択は粒子分割の精度に大きく影響するため、本研究では最適な r を自動決定するアルゴリズムを実装した。このアルゴリズムでは、r を 1 から 10 まで変動させながら、以下の 3 つの指標を監視した。

　第 1 の指標は「最大粒子体積割合」である。これは、検出された全粒子の中で最も体積が大きい粒子が全体積に占める割合を示す。r が小さすぎる場合、複数の粒子が一つの巨大な塊として認識されるため、この割合は 100% に近い値を示す。適切に分離が行われると、この割合は急激に低下する。

　第 2 の指標は「粒子数の変化率」であった。r を増加させた際の粒子数の増減を監視し、粒子数が減少に転じた場合は過分離（微小粒子の消滅）が生じていると判断した。

　第 3 の指標は「平均接触数」であった。フラン鋳型における砂粒子の平均接触数は、既往研究より 4 から 10 程度であることが報告されている 9)。この範囲から大きく逸脱する場合は、分離が不適切であると判断した。

　本アルゴリズムでは、まず最大粒子体積割合が 5% 以下となる最小の r を r* として決定した。次に、r ≥ r* の範囲において、粒子数の変化率が閾値以下かつ平均接触数が 4 から 10 の範囲に収まる最小の r を最適値として選択した。これらの条件を同時に満たす r が存在しない場合は、フォールバック処理として r\* を採用した。

#### 2.3.4 Guard Volume機能

　試料端部に位置する粒子は、切出しによって接触相手が失われており、接触数が過小評価される問題がある。Fig. 6 に境界効果の概念図を示す。同図より、ボリュームの端に位置する粒子は、本来接触しているはずの相手粒子が計算範囲外に存在するため、接触数が少なく算出されることがわかる。このような粒子を含めて統計をとると、材料本来の特性を正確に評価することができない。

　この問題を解決するため、本研究では Guard Volume（ガードボリューム）機能を開発した。Guard Volume とは、ボリュームの端から一定のマージン距離だけ内側に設定された領域であり、この領域内に完全に含まれる粒子のみを統計解析の対象とする。

　マージン距離の計算には、各粒子の等価球直径を用いた。具体的には、最大粒子の等価半径の 30% と 10 ボクセルのうち大きい方をマージン距離として採用した。ただし、マージン距離が各次元の 6% を超えないように制限し、内部領域が全体の 88% 以上を確保できるようにした。1 ボクセルが 14 μm の場合、最小マージンは約 140 μm となる。

　Guard Volume 機能により、境界効果の影響を受けた粒子を統計から除外し、材料内部の真の接触数分布を評価することが可能となった。

### 2.4 可視化手法

　解析結果を直感的に把握するため、3 次元可視化システムを構築した。可視化には、Python の 3 次元ビューア Napari を用いた。本システムでは、以下の 3 種類のレイヤー表示を実装した。

　第 1 のレイヤーは「Contact Heatmap（粒子接触ヒートマップ）」である。各粒子の 3D 形状全体を、その粒子の接触数に応じて色付けする。カラーマップには turbo を採用し、青（低接触：0〜4）から緑（中接触：5〜9）を経て赤（高接触：10 以上）へのグラデーションで表現した。これにより、粒子形状を維持したまま接触数の空間分布を直感的に把握することができる。

　第 2 のレイヤーは「Weak Zones（破断予測・危険地帯マップ）」である。構造的な弱点となる低接触粒子（接触数 0〜4）のみを抽出して強調表示する。接触数 5 以上の粒子は透明化することで、破断の起点となりうる領域を浮き上がらせて可視化する。

　第 3 のレイヤーは「Centroids（重心点群）」である。各粒子の重心位置を点として表示し、接触数に応じて色分けする。これにより、表面レンダリングでは隠れてしまう内部粒子の状態も迅速に把握することができる。

---

## 3. 結果および考察

### 3.1 収縮回数rの最適化

　Fig. 7 に収縮回数 r の変化に伴う「粒子数」と「最大粒子体積割合」の推移を示す。同図において、青色の棒グラフは粒子数を、橙色の折れ線グラフは最大粒子体積割合を示している。

　同図より、r = 1〜2 の段階では最大粒子体積割合が 100% に近い値を示していることがわかる。これは、粒子同士が結合して一つの巨大な塊として認識されている状態（未分離状態）を意味する。この段階では粒子数も 500 未満と非常に少ない。

　r = 3 付近において、最大粒子体積割合が 100% から 10% 以下へと急激に低下した。同時に、粒子数が 1000 を超える値まで大幅に増加した。これは、結合していた粒子群が個々に分離されたことを示している。

　r = 4 以降では最大粒子体積割合が 1% 未満で安定した。一方、粒子数は r = 5 で約 2200 個のピークを迎え、その後は r が増加するごとに減少傾向を示した。これは、過剰な収縮により微小な粒子が消滅し始めたことを意味する。

　Table 1 に各収縮回数における解析結果を示す。本アルゴリズムでは r = 6 が最適値として自動選択された。r = 6 における粒子数は 2013 個、平均接触数は 7.3、最大粒子体積割合は 0.4% であった。平均接触数 7.3 は既往研究で報告されている値（4〜10）の範囲内であり、妥当な分離が行われたと考えられる。

### 3.2 接触数分布の解析

　Fig. 8 に最適収縮回数 r = 6 における接触数分布のヒストグラムを示す。本ヒストグラムは Guard Volume 機能を適用し、境界効果の影響を受ける外周部の粒子を統計から除外した上で、内部粒子のみを対象として作成した。同図より、接触数の分布は正規分布に近い形状を示していることがわかる。

　統計値として、平均接触数は 7.6、中央値は 7.0 であった。分布は概ね左右対称であり、多くの粒子が 6〜9 の接触数を持っていることから、比較的均質な充填状態であることが示唆された。接触数 0 や 20 以上といった極端な外れ値は認められなかった。

　なお、Guard Volume を適用せずに全粒子で計算した場合の平均接触数は 7.3 であり、Guard Volume 適用後の値（7.6）はこれよりも高い。これは、境界効果により接触数が過小評価されていた外周部の粒子が除外されたことで、材料内部の真の接触状態がより正確に反映されたためと考えられる。

### 3.3 粒子体積と接触数の相関解析

　Fig. 9 に Guard Volume 内部粒子を対象とした、粒子体積と接触数の関係を示す散布図を示す。横軸は各粒子の体積（ボクセル数）、縦軸はその粒子の接触数を表す。

　同図より、粒子体積と接触数の間には正の相関が認められた。相関係数は R = 0.774 であり、比較的強い線形相関が存在することが示された。回帰直線の傾きは 0.0003 であった。

　データの傾向として、体積が小さい粒子（5,000 ボクセル以下）は接触数が 5 回前後であるのに対し、体積が大きい粒子（30,000 ボクセル以上）では接触数が 15 回前後まで増加する傾向が見て取れた。これは、体積の大きな粒子ほど表面積が大きく、周囲の粒子と接触する機会が増えるという幾何学的な関係を反映していると考えられる。

　この結果は、粒子充填構造の力学的挙動を考察する上で重要な知見を提供する。すなわち、大きな粒子は接触数が多いため荷重伝達の結節点として機能しやすい一方で、小さな粒子は接触数が少ないため局所的な弱点となりうる可能性がある。

### 3.4 3D可視化による内部構造の評価

　Fig. 10 に接触数に基づく 3 次元ヒートマップを示す。同図では、青色が低接触（0〜4）、緑色が中接触（5〜9）、赤色が高接触（10 以上）を表している。

　同図より、試料外周部は青色で示される低接触粒子に覆われていることがわかる。これは、切出しによって隣接粒子を失った境界効果の影響を反映している。一方、試料内部では赤色で示される高接触粒子が密集しており、これらが網目状に連なる構造が観察された。

　この網目状構造は「Force Chains（力学的骨格）」と呼ばれ、外部荷重を主として支える役割を担っていると考えられる 10)。高接触粒子群が相互に連結することで、荷重が効率的に分散される経路が形成されていることが視覚的に確認できた。

　Fig. 11 に Weak Zones（低接触領域のみを強調表示した画像）を示す。同図より、高強度の中心部（赤いコア）の中にも、低接触な粒子からなる局所的な領域が点在していることが確認できた。これらは混練不足や充填不良に起因する内部欠陥であると考えられる。

　このような局所的な低接触領域（Weak Zones）は、鋳型強度が低下した際の破壊起点となる可能性が高い。本システムにより、従来の平均値評価では捉えきれなかった空間的な構造不均一性の評価が可能となった。

### 3.5 Guard Volume機能の効果

　Fig. 12 に Guard Volume 機能適用前後の平均接触数の比較を示す。同図では、各収縮回数 r において、Guard Volume なし（全粒子）と Guard Volume あり（内部粒子のみ）の平均接触数を棒グラフで比較している。

　同図より、適切な分離が行われている r = 4 以降において、Guard Volume ありの場合は Guard Volume なしの場合と比較して平均接触数が高くなることがわかる。r = 6 において、Guard Volume なしでは平均接触数が 7.3 であったのに対し、Guard Volume ありでは平均接触数が 7.6 となった。これは、境界効果により接触数が過小評価されていた粒子が統計から正しく除外され、材料内部の真の値が算出されたためと考えられる。

　一方、r が小さい段階（r = 1〜2）では、Guard Volume ありの場合に平均接触数がかえって低くなる現象が観察された。これは、r が小さいと粒子が巨大な塊（クラスター）として認識され、その塊がガード領域に触れやすいために一斉に除外されるためと考えられる。結果として、中央に残った微小なノイズのみが計算対象となり、平均値が不当に低下した。

　このことから、Guard Volume 機能は適切な収縮回数と組み合わせることで効果を発揮することが明らかとなった。

### 3.6 システムの妥当性検証

　開発したシステムの妥当性を検証するため、体積分布から計算した平均粒径と実測粒度分布の平均直径を比較した。

　本システムで得られた体積分布より、平均体積は 11,450 ボクセルであった。1 ボクセルが 14 μm の立方体であることから、実体積は以下のように計算される。

　実体積 = 11,450 × (14 μm)³ = 11,450 × 2,744 μm³ = 31,418,800 μm³

　この体積から等価球直径を計算すると、

　d = 2 × ∛(3V / 4π) = 2 × ∛(3 × 31,418,800 / 4π) ≈ 391 μm

　となる。

　一方、実測粒度分布から得られた平均直径は 362 μm であった。システムで計算した値（391 μm）と実測値（362 μm）の誤差は約 8% であり、高い一致性を示した。この結果から、本システムによる 3D 構造解析の妥当性が確認された。

　誤差の要因としては、CT 画像の解像度限界、二値化閾値の影響、および砂粒子の非球形性などが考えられる。しかし、8% 程度の誤差は実用上許容できる範囲であり、本システムがフラン鋳型の内部構造解析に有効であることが示された。

---

## 4. 結言

　フラン鋳型の内部構造の理解のために X 線 CT の出力画像から鋳物砂粒子の接触数を求めるプログラムとして、2 段階大津の二値化、ユークリッド距離変換および Watershed 法によるラベリングを行った結果、以下のことが分かった。

(1) 収縮回数 r が小さい段階（r = 1〜2）では最大粒子割合が 100% に近く粒子同士が結合して一つの巨大な塊として認識されるが、r = 3 付近でこの割合が急激に低下し、同時に粒子数が大幅に増加することから、結合していた粒子群が個々に分離されることが分かった。

(2) 収縮回数を過剰に大きくすると（r = 6 以降）、微小な粒子が消滅し粒子数が減少に転じることから、未分離と過分離のバランスが最適となる点を自動決定する手法の必要性が明らかとなった。本研究で開発したアルゴリズムにより、最大粒子体積割合、粒子数変化率、および平均接触数を監視することで最適な収縮回数を自動決定することが可能となった。

(3) Guard Volume を用いて境界効果の影響を除外した内部領域では、接触数 10 以上の高接触粒子群が網目状に連なる Force Chains が形成されており、これらが外部荷重を主として支えている構造が明らかとなった。また、高強度領域の中にも局所的な低接触領域（Weak Zones）が存在し、これらが破壊起点となる可能性が示唆された。

(4) Guard Volume 内部粒子を対象とした散布図解析により、粒子体積と接触数の間に比較的強い正の相関（R = 0.774）が存在することが明らかとなった。体積の大きな粒子ほど接触数が多く荷重伝達の結節点として機能しやすい一方、小さな粒子は接触数が少なく局所的な弱点となりうることが示された。

(5) 体積分布から計算した平均粒径（391 μm）と実測粒度分布の平均直径（362 μm）が高い一致性を示したことから、本システムによる 3D 構造解析の妥当性が確認された。

---

## 5. 参考文献

1） 黒川 豊, 簑輪 幸三, 丸山 徹: 鋳造工学, **90**(2018), 474.

2） 黒川 豊, 木内 一彦: 鋳造工学, **89**(2017), 517.

3） 小谷 友勝, 佐藤 理紗, 荻野 知也, 安達 将志, 目次 真一: 鋳造工学 全国講演大会講演概要集, **164**(2014), 42.

4） 長井 壮一, 枝根 和也, 天久 裕樹, 黄 子争, 黒川 豊: 鋳造工学 全国講演大会講演概要集, **167**(2015), 97-98.

5） 浅野 勇, 向後 雄二, 林田 洋一: 農業土木学会論文集, **2006**(2006), 931-938.

6） 戸田裕之: X 線 CT －産業・理工学でのトモグラフィー実践活用－, (共立出版, 東京, 2019), pp. 355-387.

7） N. Otsu: IEEE Trans. Sys., Man., and Cyber., **9**(1979), 62-66.

8） 三輪茂雄: 粉体工学通論, (日刊工業新聞社, 東京, 1981), pp. 52-68.

9） G. T. Nolan and P. E. Kavanagh: Powder Technol., **72**(1992), 149-155.

10） J. F. Peters, M. Muthuswamy, J. Wibowo and A. Tordesillas: Phys. Rev. E, **72**(2005), 041307.

---

## 謝辞

　本研究を遂行するにあたり、終始多大なるご指導を賜りました関西大学化学生命工学部化学・物質工学科教授、博士(工学)、丸山 徹先生に深く感謝の意を表します。並びに、種々の御指導を下さいました関西大学化学生命工学部化学・物質工学科の諸先生方に深く感謝の意を表すとともに、技術的な御指導を賜りました堂本 涼介技師に心より御礼申し上げます。そして、種々のご指導を下さいました融体加工研究室の皆様に厚く御礼申し上げます。

---

## 図の説明

### Fig. 1 使用した鋳物砂の粒度分布

内容: 横軸に粒径（μm）、縦軸に頻度（%）をとった棒グラフ。

意味: 平均直径 362 μm の粒子が 61.9% を占めていることを示し、比較的均一な粒度分布を有する砂を使用したことを示している。

---

### Fig. 2 二値化の模式図

内容: 上段にぼやけたグレースケール画像（境界が不明瞭な領域）、下段にくっきりとした白と黒の二値画像。

意味: 大津の二値化により、砂粒子と空間を客観的な境界で切り分ける処理を示している。矢印で示した領域の輪郭が、二値化により明瞭になる様子を表現している。

---

### Fig. 3 フラン鋳型試料のX線CT像（二値化後）

内容: 実際の断面画像。白色の領域（砂粒子）が密集しており、その間に黒色の隙間（空隙・樹脂）が存在する。

意味: 多くの砂粒子が互いに接触して繋がって見えており、これらを個別に分離（ラベリング）する必要があることを示唆している。

---

### Fig. 4 距離変換の概念図

内容: 二値化された粒子画像において、各ピクセルから最も近い背景までの距離を色で表現した図。中心部ほど明るく、境界部ほど暗い。

意味: 粒子中心の検出に用いる距離変換の原理を説明している。この距離データを Watershed 法の入力として使用する。

---

### Fig. 5 画像収縮の模式図

内容: (a) 接触した粒子とノイズ → (b) ノイズが分離 → (c) 粒子同士が分離 → (d) 過剰収縮で粒子が消滅、という 4 段階のプロセスを示す模式図。

意味: 画像を「削る」ことで、くっついた粒子を切り離し、かつノイズを除去するアルゴリズムの仕組みを説明している。収縮回数 r の選択が重要であることを視覚的に示している。

---

### Fig. 6 境界効果の概念図

内容: 3D ボリュームの断面図。端部に位置する粒子が、本来接触しているはずの相手粒子（ボリューム外に存在）を失っている様子を示す。

意味: 境界効果により接触数が過小評価される問題を説明し、Guard Volume 機能の必要性を示している。

---

### Fig. 7 収縮回数 r と最大粒子体積割合・粒子数の関係

内容: 横軸に収縮回数 r（1〜10）、左縦軸に粒子数（青色棒グラフ）、右縦軸に最大粒子体積割合（%）（橙色折れ線グラフ）をとった 2 軸グラフ。

意味: r = 1〜2 で高く留まっていた最大粒子割合が r = 3 で急落し、それと入れ替わるように粒子数が急増する様子を示している。r = 5 で粒子数がピークを迎え、その後は減少に転じることから、過分離の傾向も確認できる。

---

### Fig. 8 最適収縮回数 r = 6 における接触数分布ヒストグラム（Guard Volume 適用）

内容: 横軸に接触数、縦軸に頻度をとったヒストグラム。Guard Volume 機能により境界粒子を除外し、内部粒子のみを対象としている。

意味: 平均接触数 7.6、中央値 7.0 の正規分布に近い形状を示し、比較的均質な充填状態であることを表している。Guard Volume 適用前（全粒子）の平均接触数 7.3 と比較して高い値を示しており、境界効果の除外による補正効果が確認できる。

---

### Fig. 9 粒子体積と接触数の散布図（Guard Volume 内部粒子）

内容: 横軸に粒子体積（ボクセル数）、縦軸に接触数をとった散布図。回帰直線（破線）と相関係数 R を併記している。

意味: 粒子体積と接触数の間に正の相関（R = 0.774）が存在することを示している。体積の大きな粒子ほど接触数が多く、荷重伝達の結節点として機能しやすいことを示唆している。

---

### Fig. 10 接触数に基づく3次元ヒートマップ（Contact Heatmap）

内容: 砂粒子の集合体を 3 次元的に捉え、各粒子の接触数を色で塗り分けた画像。青（低接触：0〜4）→ 緑（中接触：5〜9）→ 赤（高接触：10 以上）のグラデーション。

意味: 外周部が青色（境界効果）で覆われ、内部に赤色の高接触粒子が密集する様子を示している。網目状に連なる赤い領域が Force Chains を形成していることが視覚的に確認できる。

---

### Fig. 11 Weak Zones（破断予測・危険地帯マップ）

内容: 低接触粒子（接触数 0〜4）のみを抽出し、それ以外を透明化した画像。

意味: 高強度の中心部の中にも、孤立した低接触領域（青や緑の粒子）が点在していることを示している。これらが破壊起点となる可能性を視覚的に示唆している。

---

### Fig. 12 Guard Volume機能適用前後の平均接触数比較

内容: 横軸に収縮回数 r、縦軸に平均接触数をとった棒グラフ。青色が Guard Volume あり、橙色が Guard Volume なしを表す。

意味: 適切な分離条件（r ≥ 4）において、Guard Volume を適用することで平均接触数が上昇し、境界効果が正しく除外されていることを示している。

---

### Table 1 各収縮回数 r における解析結果

内容: 収縮回数 r、粒子数、平均接触数、最大粒子割合（%）、処理時間（秒）、ステータス（OPTIMAL 等）を示した表。

意味: r = 6 が最適値として選択され、粒子数 2013、平均接触数 7.3、最大粒子割合 0.4% という結果を示している。

| r   | 粒子数 | 平均接触数 | 最大粒子割合 (%) | 処理時間 (秒) | ステータス |
| --- | ------ | ---------- | ---------------- | ------------- | ---------- |
| 1   | 491    | 2.1        | 99.8             | 91.0          | Computed   |
| 2   | 382    | 2.3        | 98.0             | 75.6          | Computed   |
| 3   | 1321   | 6.5        | 5.4              | 121.8         | Computed   |
| 4   | 1974   | 7.0        | 0.7              | 188.0         | Computed   |
| 5   | 2196   | 7.0        | 0.4              | 181.2         | Computed   |
| 6   | 2013   | 7.3        | 0.4              | 204.4         | ★ OPTIMAL  |
| 7   | 1712   | 7.6        | 0.4              | 240.6         | Computed   |
| 8   | 1346   | 8.2        | 0.4              | 175.0         | Computed   |
| 9   | 911    | 8.8        | 0.6              | 139.2         | Computed   |
| 10  | 492    | 9.6        | 1.0              | 96.4          | Computed   |
